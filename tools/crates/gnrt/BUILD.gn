# Copyright 2022 The Chromium Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/config/rust.gni")
import("//build/rust/rust_executable.gni")

rust_executable("gnrt") {
  # Mark this tool testonly so we can use more third-party crates. This tool
  # is neither built into Chromium nor used directly in the build process. It
  # is only run by developers and the output is checked in.
  testonly = true

  crate_root = "main.rs"
  sources = [
    "download.rs",
    "gen.rs",
    "main.rs",
    "util.rs",
  ]

  deps = [
    "//third_party/rust/anyhow/v1:test_support",
    "//third_party/rust/cargo_metadata/v0_14:test_support",
    "//third_party/rust/clap/v4:test_support",
    "//third_party/rust/env_logger/v0_10:test_support",
    "//third_party/rust/log/v0_4:test_support",
    "//third_party/rust/semver/v1:test_support",
    "//third_party/rust/serde/v1:lib",
    "//third_party/rust/serde_json/v1:test_support",
    "//third_party/rust/toml/v0_5:test_support",
    "//tools/crates/gnrt/lib",
  ]

  test_inputs = [ "test_metadata.json" ]
}
